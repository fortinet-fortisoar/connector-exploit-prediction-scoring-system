{
    "name": "exploit-prediction-scoring-system",
    "version": "1.0.0",
    "label": "Exploit Prediction Scoring System (EPSS)",
    "description": "The Exploit Prediction Scoring System (EPSS) is a data-driven effort for estimating the likelihood (probability) that a software vulnerability will be exploited in the wild",
    "publisher": "Fortinet",
    "icon_small_name": "samll.png",
    "icon_large_name": "large.png",
    "category": "Utilities",
    "active": true,
    "cs_compatible": true,
    "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/exploit-prediction-scoring-system-epss/627/epss-v1-0-0",
    "cs_approved": false,
    "configuration": {},
    "operations": [
        {
            "operation": "get_epss_score",
            "title": "Get EPSS Score",
            "annotation": "get_epss_score",
            "description": "Fetches EPSS scores of recent CVEs.",
            "category": "investigation",
            "is_config_required": true,
            "visible": true,
            "enabled": true,
            "parameters": [
                {
                    "title": "Scope",
                    "type": "select",
                    "name": "scope",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "value": "Public",
                    "tooltip": "1. Public (default) - Shows the basic EPSS data (cve, epss, percentile, created).\n2. Time Series - Shows the last 30 days (or what is available) of the EPSS score and percentile for any CVE.",
                    "description": "Specify the scope to fetch accordingly. It can be \"public (default)\" or \"time-series\"",
                    "options": [
                        "Public",
                        "Time Series"
                    ]
                },
                {
                    "title": "By Date",
                    "type": "datetime",
                    "name": "byDate",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": null,
                    "tooltip": "Specify Date to check CVEs for particular date.",
                    "description": "Specify Date to check CVEs for particular date."
                },
                {
                    "title": "Fields",
                    "type": "text",
                    "name": "fields",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Comma separated list of fieldnames to be retrieved.",
                    "description": "Comma separated list of fieldnames to be retrieved. Used only for limiting the available resultset."
                },
                {
                    "title": "Limit",
                    "type": "integer",
                    "name": "limit",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Should be a number between 1 and 100.",
                    "description": "Limits the maximun number of records to be shown."
                },
                {
                    "title": "Offset",
                    "type": "integer",
                    "name": "offset",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "The first item is 0.",
                    "description": "Offsets the list of records by this number."
                },
                {
                    "title": "Sort",
                    "type": "text",
                    "name": "sort",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Fields starting with \"-\" (minus sign) indicate a descending order.",
                    "description": "Comma-separated list of fieldnames to be used to sort the resultset. Fields starting with \"-\" (minus sign) indicate a descending order."
                },
                {
                    "title": "Envelope",
                    "type": "checkbox",
                    "name": "envelope",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": true,
                    "tooltip": "Use true, false, 0 or 1. If set to \"true\" will add an object wrapping the resultset, with details on the status, total records found, offset and limit. When \"false\" this information is returned at the response header. Defaults to \"true\".",
                    "description": "Use true, false, 0 or 1. If set to \"true\" will add an object wrapping the resultset, with details on the status, total records found, offset and limit. When \"false\" this information is returned at the response header. Defaults to \"true\"."
                },
                {
                    "title": "Pretty",
                    "type": "checkbox",
                    "name": "pretty",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": true,
                    "tooltip": "Use true, false, 0 or 1. If the result should be pretty-printed or no. Defaults to \"true\".",
                    "description": "Use true, false, 0 or 1. If the result should be pretty-printed or no. Defaults to \"true\"."
                },
                {
                    "title": "Order Result",
                    "type": "checkbox",
                    "name": "orderResult",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": false,
                    "tooltip": "Specify the field and type to order the CVEs by.",
                    "description": "Specify the field and type to order the CVEs by.",
                    "onchange": {
                        "true": [
                            {
                                "name": "orderField",
                                "title": "Field",
                                "type": "select",
                                "required": true,
                                "visible": true,
                                "editable": true,
                                "value": "CVE",
                                "tooltip": "Specifiy field to filter data by.",
                                "description": "Specifiy field to filter data by.",
                                "options": [
                                    "CVE",
                                    "EPSS Score",
                                    "EPSS Percentile",
                                    "Date"
                                ]
                            },
                            {
                                "name": "orderIn",
                                "title": "Order In",
                                "type": "select",
                                "required": true,
                                "visible": true,
                                "editable": true,
                                "value": "Ascending",
                                "tooltip": "Specifiy Ascending or Descending to sort data by.",
                                "description": "Specifiy Ascending or Descending to sort data by.",
                                "options": [
                                    "Ascending",
                                    "Descending"
                                ]
                            }
                        ]
                    }
                }
            ],
            "output_schema": {
                "data": [
                    {
                        "cve": "",
                        "date": "",
                        "epss": "",
                        "percentile": ""
                    }
                ],
                "limit": "",
                "total": "",
                "access": "",
                "offset": "",
                "status": "",
                "version": "",
                "status-code": ""
            },
            "open": false
        },
        {
            "operation": "get_epss_score_by_cve_id",
            "title": "Get EPSS Score By CVE ID",
            "annotation": "get_epss_score_by_cve_id",
            "description": "Fetches EPSS score for single or list of CVE",
            "category": "investigation",
            "is_config_required": true,
            "visible": true,
            "enabled": true,
            "parameters": [
                {
                    "title": "Scope",
                    "type": "select",
                    "name": "scope",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": "Public",
                    "tooltip": "1. Public (default) - Shows the basic EPSS data (cve, epss, percentile, created).\n2. Time Series - Shows the last 30 days (or what is available) of the EPSS score and percentile for any CVE.",
                    "description": "Specify the scope to fetch accordingly. It can be \"public (default)\" or \"time-series\"",
                    "options": [
                        "Public",
                        "Time Series"
                    ]
                },
                {
                    "title": "CVE ID",
                    "type": "text",
                    "name": "cve",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Specify CVE ID or list of CVE ID.",
                    "description": "Specify CVE ID or list of CVE ID to fetch EPSS Score."
                },
                {
                    "title": "By Date",
                    "type": "datetime",
                    "name": "byDate",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": null,
                    "tooltip": "Specify Date to check CVEs for particular date.",
                    "description": "Specify Date to check CVEs for particular date."
                },
                {
                    "title": "Fields",
                    "type": "text",
                    "name": "fields",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Comma separated list of fieldnames to be retrieved.",
                    "description": "Comma separated list of fieldnames to be retrieved. Used only for limiting the available resultset."
                },
                {
                    "title": "Sort",
                    "type": "text",
                    "name": "sort",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Fields starting with \"-\" (minus sign) indicate a descending order.",
                    "description": "Comma-separated list of fieldnames to be used to sort the resultset. Fields starting with \"-\" (minus sign) indicate a descending order."
                },
                {
                    "title": "Envelope",
                    "type": "checkbox",
                    "name": "envelope",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": true,
                    "tooltip": "Use true, false, 0 or 1. If set to \"true\" will add an object wrapping the resultset, with details on the status, total records found, offset and limit. When \"false\" this information is returned at the response header. Defaults to \"true\".",
                    "description": "Use true, false, 0 or 1. If set to \"true\" will add an object wrapping the resultset, with details on the status, total records found, offset and limit. When \"false\" this information is returned at the response header. Defaults to \"true\"."
                },
                {
                    "title": "Pretty",
                    "type": "checkbox",
                    "name": "pretty",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": true,
                    "tooltip": "Use true, false, 0 or 1. If the result should be pretty-printed or no. Defaults to \"true\".",
                    "description": "Use true, false, 0 or 1. If the result should be pretty-printed or no. Defaults to \"true\"."
                },
                {
                    "title": "Order Result",
                    "type": "checkbox",
                    "name": "orderResult",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "value": false,
                    "tooltip": "Specify the field and type to order the CVEs by.",
                    "description": "Specify the field and type to order the CVEs by.",
                    "onchange": {
                        "true": [
                            {
                                "name": "orderField",
                                "title": "Field",
                                "type": "select",
                                "required": true,
                                "visible": true,
                                "editable": true,
                                "value": "CVE",
                                "tooltip": "Specifiy field to filter data by.",
                                "description": "Specifiy field to filter data by.",
                                "options": [
                                    "CVE",
                                    "EPSS Score",
                                    "EPSS Percentile",
                                    "Date"
                                ]
                            },
                            {
                                "name": "orderIn",
                                "title": "Order In",
                                "type": "select",
                                "required": true,
                                "visible": true,
                                "editable": true,
                                "value": "Ascending",
                                "tooltip": "Specifiy Ascending or Descending to sort data by.",
                                "description": "Specifiy Ascending or Descending to sort data by.",
                                "options": [
                                    "Ascending",
                                    "Descending"
                                ]
                            }
                        ]
                    }
                }
            ],
            "output_schema": {
                "data": [
                    {
                        "cve": "",
                        "date": "",
                        "epss": "",
                        "percentile": ""
                    }
                ],
                "limit": "",
                "total": "",
                "access": "",
                "offset": "",
                "status": "",
                "version": "",
                "status-code": ""
            },
            "open": false
        }
    ]
}